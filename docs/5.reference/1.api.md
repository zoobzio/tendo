---
title: API Reference
description: Complete API reference for the tendo package
author: zoobzio
published: 2025-12-16
updated: 2025-12-16
tags:
  - Reference
  - API
  - Functions
  - Types
---

# API Reference

Complete API reference for the `github.com/zoobzio/tendo` package.

## Tensor

The core tensor type.

### NewTensor

```go
func NewTensor(storage Storage, shape []int, stride []int) *Tensor
```

Creates a tensor wrapping storage with given shape. If stride is nil, computes row-major stride.

### Tensor Methods

#### Shape

```go
func (t *Tensor) Shape() []int
```

Returns the tensor dimensions.

#### Stride

```go
func (t *Tensor) Stride() []int
```

Returns the memory stride for each dimension.

#### Dim

```go
func (t *Tensor) Dim() int
```

Returns the number of dimensions.

#### Size

```go
func (t *Tensor) Size(dim int) int
```

Returns the size of a specific dimension. Supports negative indexing.

#### Numel

```go
func (t *Tensor) Numel() int
```

Returns the total number of elements.

#### Offset

```go
func (t *Tensor) Offset() int
```

Returns the offset into storage (for views/slices).

#### Device

```go
func (t *Tensor) Device() Device
```

Returns the device where the tensor resides.

#### DType

```go
func (t *Tensor) DType() DType
```

Returns the element data type.

#### Storage

```go
func (t *Tensor) Storage() Storage
```

Returns the underlying storage.

#### IsContiguous

```go
func (t *Tensor) IsContiguous() bool
```

Returns true if elements are laid out sequentially in memory.

#### Contiguous

```go
func (t *Tensor) Contiguous() *Tensor
```

Returns a contiguous copy if non-contiguous, otherwise returns self.

#### Clone

```go
func (t *Tensor) Clone() *Tensor
```

Creates a deep copy of the tensor.

#### Free

```go
func (t *Tensor) Free()
```

Releases the underlying storage.

#### View

```go
func (t *Tensor) View(shape ...int) (*Tensor, error)
```

Returns a new tensor with different shape sharing the same storage. Requires contiguous tensor.

#### Reshape

```go
func (t *Tensor) Reshape(shape ...int) (*Tensor, error)
```

Returns a reshaped tensor. Creates a view if contiguous, otherwise copies data.

#### String

```go
func (t *Tensor) String() string
```

Returns a string representation of tensor metadata.

## Constructors

### FromSlice

```go
func FromSlice(data []float32, shape ...int) *Tensor
func FromSliceOn(data []float32, device Device, shape ...int) *Tensor
```

Creates a tensor from a slice. Panics if data length doesn't match shape.

### Empty

```go
func Empty(shape ...int) *Tensor
func EmptyOn(device Device, shape ...int) *Tensor
func EmptyLike(t *Tensor) *Tensor
```

Creates an uninitialized tensor.

### Zeros

```go
func Zeros(shape ...int) *Tensor
func ZerosOn(device Device, shape ...int) *Tensor
func ZerosLike(t *Tensor) *Tensor
```

Creates a tensor filled with zeros.

### Ones

```go
func Ones(shape ...int) *Tensor
func OnesOn(device Device, shape ...int) *Tensor
func OnesLike(t *Tensor) *Tensor
```

Creates a tensor filled with ones.

### Full

```go
func Full(value float32, shape ...int) *Tensor
func FullOn(value float32, device Device, shape ...int) *Tensor
```

Creates a tensor filled with a value.

### Rand

```go
func Rand(shape ...int) *Tensor
func RandOn(device Device, shape ...int) *Tensor
func RandLike(t *Tensor) *Tensor
```

Creates a tensor with uniform random values in [0, 1).

### RandN

```go
func RandN(shape ...int) *Tensor
func RandNOn(device Device, shape ...int) *Tensor
func RandNLike(t *Tensor) *Tensor
```

Creates a tensor with standard normal random values.

### Arange

```go
func Arange(start, end, step float32) *Tensor
func ArangeOn(start, end, step float32, device Device) *Tensor
```

Creates a 1D tensor with values from start to end (exclusive).

### Linspace

```go
func Linspace(start, end float32, n int) *Tensor
func LinspaceOn(start, end float32, n int, device Device) *Tensor
```

Creates a 1D tensor with n evenly spaced values.

### Eye

```go
func Eye(n int) *Tensor
func EyeOn(n int, device Device) *Tensor
```

Creates an n√ón identity matrix.

## Device

### Device Type

```go
type Device struct {
    Type  DeviceType
    Index int
}

type DeviceType uint8

const (
    CPU  DeviceType = iota
    CUDA
)
```

### Device Constructors

```go
func CPUDevice() Device
func CUDADevice(index int) Device
```

### Device Methods

```go
func (d Device) IsCPU() bool
func (d Device) IsCUDA() bool
func (d Device) String() string
```

### Default Device

```go
func DefaultDevice() Device
func SetDefaultDevice(d Device)
```

### CUDA Availability

```go
func IsCUDAAvailable() bool
func CUDADeviceCount() int
```

## Data Types

### DType

```go
type DType uint8

const (
    Float32  DType = iota
    Float16
    BFloat16
)
```

### DType Methods

```go
func (d DType) String() string
func (d DType) Size() int
```

### Default DType

```go
func DefaultDType() DType
func SetDefaultDType(d DType)
```

### Low-Level Conversion

```go
func Float32ToFloat16(f float32) uint16
func Float16ToFloat32(h uint16) float32
func Float32ToBFloat16(f float32) uint16
func BFloat16ToFloat32(b uint16) float32

func Float32SliceToFloat16(f32 []float32) []uint16
func Float16SliceToFloat32(f16 []uint16) []float32
func Float32SliceToBFloat16(f32 []float32) []uint16
func BFloat16SliceToFloat32(bf16 []uint16) []float32
```

## Storage

### Storage Interface

```go
type Storage interface {
    Ptr() uintptr
    Size() int
    Len() int
    Device() Device
    DType() DType
    Clone() Storage
    Free()
}
```

### CPUStorage

```go
func NewCPUStorage(numel int, dtype DType) *CPUStorage
func NewCPUStorageFromSlice(data []float32, dtype DType) *CPUStorage

func (s *CPUStorage) Data() []float32
func (s *CPUStorage) SetData(index int, value float32)
func (s *CPUStorage) GetData(index int) float32
func (s *CPUStorage) Fill(value float32)
```

### CUDAStorage

```go
func NewCUDAStorage(numel int, dtype DType, device int) (*CUDAStorage, error)
func NewCUDAStorageFromSlice(data []float32, dtype DType, device int) (*CUDAStorage, error)
func NewCUDAStorageFromPool(numel int, dtype DType, device int, pool *Pool) (*CUDAStorage, error)

func (s *CUDAStorage) CopyFromHost(data []float32) error
func (s *CUDAStorage) CopyToHost() ([]float32, error)
func (s *CUDAStorage) CopyToHostSlice(dst []float32) error
func (s *CUDAStorage) Zero() error
func (s *CUDAStorage) Fill(value float32) error
func (s *CUDAStorage) Sync() error
```

## Pool

### Pool Type

```go
func NewPool() *Pool
func DefaultPool() *Pool
func SetDefaultPool(p *Pool)
```

### Pool Methods

```go
func (p *Pool) SetContext(ctx context.Context)
func (p *Pool) AllocCPU(numel int, dtype DType) *CPUStorage
func (p *Pool) FreeCPU(storage *CPUStorage)
func (p *Pool) AllocCUDA(numel int, dtype DType, device int) (uintptr, error)
func (p *Pool) FreeCUDA(ptr uintptr, numel int, dtype DType, device int)
func (p *Pool) Clear()
func (p *Pool) Stats() PoolStats
```

### PoolStats

```go
type PoolStats struct {
    CPUAllocations   int64
    CPUDeallocations int64
    CPUBytesInUse    int64
    CPUBytesCached   int64

    CUDAAllocations   map[int]int64
    CUDADeallocations map[int]int64
    CUDABytesInUse    map[int]int64
    CUDABytesCached   map[int]int64
}
```

## Shape Utilities

```go
func Numel(shape []int) int
func ComputeStrides(shape []int) []int
func IsContiguous(shape, stride []int) bool
func BroadcastShapes(a, b []int) ([]int, error)
func InferShape(numel int, shape []int) ([]int, error)
```

## Context Utilities

```go
func WithTraining(ctx context.Context) context.Context
func WithInference(ctx context.Context) context.Context
func IsTraining(ctx context.Context) bool
```

## Chainable Builders

```go
func Op(name pipz.Name, fn func(context.Context, *Tensor) (*Tensor, error)) pipz.Chainable[*Tensor]
func Transform(name pipz.Name, fn func(context.Context, *Tensor) *Tensor) pipz.Chainable[*Tensor]
```

## Error Types

### ShapeError

```go
type ShapeError struct {
    Op      string
    ShapeA  []int
    ShapeB  []int
    Message string
}

func (e *ShapeError) Error() string
```

### DeviceError

```go
type DeviceError struct {
    Expected DeviceType
    Got      DeviceType
}

func (e *DeviceError) Error() string
```

### DeviceMismatchError

```go
type DeviceMismatchError struct {
    A Device
    B Device
}

func (e *DeviceMismatchError) Error() string
```

### CUDAError

```go
type CUDAError struct {
    Code    int
    Message string
}

func (e *CUDAError) Error() string

var ErrCUDANotAvailable = errors.New("CUDA not available: no CUDA devices found")
```

## Signals

See [Observability Cookbook](../4.cookbook/2.observability.md) for usage.

### Lifecycle

```go
var TensorCreated = capitan.NewSignal("tendo.tensor.created", "Tensor allocated")
var TensorFreed = capitan.NewSignal("tendo.tensor.freed", "Tensor deallocated")
var TensorTransfer = capitan.NewSignal("tendo.tensor.transfer", "Tensor moved between devices")
```

### Operations

```go
// Element-wise
var OpAdd, OpSub, OpMul, OpDiv capitan.Signal
var OpNeg, OpAbs, OpExp, OpLog, OpSqrt, OpSquare, OpPow capitan.Signal

// Matrix
var OpMatMul, OpTranspose capitan.Signal

// Shape
var OpReshape, OpSqueeze, OpUnsqueeze capitan.Signal
var OpSlice, OpExpand, OpCat, OpStack capitan.Signal

// Reduction
var OpSum, OpMean, OpMax, OpMin capitan.Signal
var OpArgMax, OpArgMin capitan.Signal

// Activation
var OpReLU, OpSigmoid, OpTanh, OpGELU capitan.Signal
var OpSoftmax, OpLogSoftmax, OpDropout capitan.Signal

// Convolution
var OpConv2d capitan.Signal

// Type cast
var OpCast capitan.Signal
```

### Memory

```go
var PoolAlloc = capitan.NewSignal("tendo.pool.alloc", "Memory allocated from pool")
var PoolFree = capitan.NewSignal("tendo.pool.free", "Memory returned to pool")
```

### Field Keys

```go
var KeyInput = capitan.NewKey[*Tensor]("input", VariantTensor)
var KeyInputA = capitan.NewKey[*Tensor]("input_a", VariantTensor)
var KeyInputB = capitan.NewKey[*Tensor]("input_b", VariantTensor)
var KeyInputs = capitan.NewKey[[]*Tensor]("inputs", VariantTensorList)
var KeyOutput = capitan.NewKey[*Tensor]("output", VariantTensor)
var KeyShape = capitan.NewKey[[]int]("shape", VariantShape)
var KeyDevice = capitan.NewKey[Device]("device", VariantDevice)
var KeyFromDevice = capitan.NewKey[Device]("from_device", VariantDevice)
var KeyToDevice = capitan.NewKey[Device]("to_device", VariantDevice)
var KeyDim = capitan.NewIntKey("dim")
var KeyDims = capitan.NewKey[[]int]("dims", VariantShape)
var KeyBytes = capitan.NewIntKey("bytes")
var KeyScalar = capitan.NewFloat32Key("scalar")
var KeyOpName = capitan.NewStringKey("op_name")
var KeySrcType = capitan.NewKey[DType]("src_dtype", VariantDType)
var KeyDstType = capitan.NewKey[DType]("dst_dtype", VariantDType)
```

## Convolution Types

### Conv2dConfig

```go
type Conv2dConfig struct {
    Padding  [2]int // [padH, padW]
    Stride   [2]int // [strideH, strideW]
    Dilation [2]int // [dilationH, dilationW]
    Groups   int    // number of groups for grouped convolution
}

func DefaultConv2dConfig() Conv2dConfig
func Conv2dOutputShape(inputShape, weightShape []int, config Conv2dConfig) []int
```
